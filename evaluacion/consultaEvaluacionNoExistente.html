<HTML>
<HEAD>
<TITLE>INGENIUM::ERP::ENTERPRISE RESOURCE PLANNING</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<style> body, html {margin:0px; padding: 0px; overflow: hidden;} </style>
<script type="text/javascript" src="../lib/fisheyes/jquery.js"></script>
<script type="text/javascript" src="../lib/fisheyes/interface.js"></script>

<script language="javascript1.2" src="../lib/omnisoft.js"></script><script language="javascript1.2" src="../lib/zpmenu/utils/utils.js"></script>
<script language="javascript1.2" src="../lib/zpmenu/src/menu.js"></script>



<!--[if lt IE 7]>
 <style type="text/css">
 .dock img { behavior: url(../lib/fisheyes/iepngfix.htc) }
 </style>
<![endif]-->

<script language="JavaScript" type="text/JavaScript">
<!--
function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_swapImgRestore() { //v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
}

function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}

function MM_swapImage() { //v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
}
//-->
</script>
</HEAD>
<BODY onLoad="initDisableRight();"  LEFTMARGIN=0 TOPMARGIN=0 MARGINWIDTH=0 MARGINHEIGHT=0 onLoad="MM_preloadImages('../images/bot_insertar_b.gif','../images/bot_editar_b.gif','../images/bot_buscar_b.gif','../images/bot_eliminar_b.gif','../images/bot_correo_b.gif','../images/bot_graficar_b.gif','../images/bot_imprimir_b.gif','../images/bot_ayuda_b.gif','../images/bot_acercad_b.gif','../images/bot_salir_b.gif','../images/bot_home_b.gif','../images/bot_inicio_b.gif','../images/bot_anterior_b.gif','../images/bot_siguiente_b.gif','../images/bot_ultimo_b.gif','../images/bot_xml_b.gif','../images/bot_excel_b.gif')">
<script> window.status='Diseñado y Desarrollado por Omnisoft Cia Ltda http://www.omnisoft.cc';</script>

<table width="100%" height="541" border="0" cellpadding="0" cellspacing="0" >
  <tr>
    <td height="541" valign="top">
      <div align="center">
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tr>            <td> <div align="right">
                <table width="100%" height="45" border="0" cellpadding="0" cellspacing="0" class="maintoptitle" >
                  <tr valign="top">
                    <td width="222" height="45" valign="bottom" class="ingeniumtoptitle"></td>                    <td width="482"  class="toptitle" > <center>
                        <br>
                        EVALUACIONES PENDIENTES
                    </center></td>
                    <td width="40" valign="bottom" ><img id="imgFoto" src="../fotos/foto.jpg" width="37" height="45"></td>
                     <td width="169"  valign="middle" class="toptitle">
                                        <script>document.write(getCookie('nombre_usr')+' '+getCookie('apellido_usr')); </script></td>
                    <td width="128" class="logotoptitle"></td>

                  </tr>
                </table>
                <table width="100%" border="0" cellspacing="0" cellpadding="0">
                  <tr>
                    <td><img src="../images/ind_01_back.jpg" width="100%" height="7"></td>
                  </tr>
                </table>
              </div></td>
          </tr>
          <tr>  <td height="20" class="menuborder" >
		<ul id="myMenu" class='zpHideOnLoad'>            </ul>        <script>
           //   OmnisoftPerfilUsuario(moduloEvaluacion);
            </script>
</td>

          </tr>
          <tr>            <td height="412" valign="top" >
			<div align="center">
                <table width="100%" height="447" border="0" align="center" cellpadding="0" cellspacing="0">
                  <tr>
                    <td width="1123" height="447" colspan="2" >
        <script>
		
		var query=parent.location.href.split('|');
		/*alert(query[0]);
		alert(query[1]);// periodo
		alert(query[2]);// tipo evaluadores
		alert("NO EXISTENTE")*/
		
		/*var filtro=' where familiaactivofijo.serial_faf=tipoactivofijo.serial_faf and tipoactivofijo.serial_taf=activosfijos.serial_taf';
                var campo='';
                var fecha='';

		for (var i=1; i < query.length; i++) {
		   campo=query[i].split('=');
                   if ( campo[1]!='' && campo[1]!='""' && campo[1]!='"TODOS"' && campo[1]!='"0.00"' && campo[1]!='"0000-00-00"' && campo[1]!='"0"')
                      if (campo[0]=='codigo_com')
		          filtro=filtro+' and '+'comprobante.'+query[i];
                      else
                      if (campo[0]=='serial_plc')
		      filtro=filtro+' and '+'familiaactivofijo.'+query[i];
		      else
		      if (campo[0]=='razonSocial_pvd')
                      filtro=filtro+' and '+'proveedor.'+campo[0]+' like "'+campo[1].split('"')[1]+'%"';
		      else {
                            fecha=campo[0].split('Desde');
                            if (fecha.length>1)
		               filtro=filtro+' and '+'activosfijos.'+fecha[0]+fecha[1]+' >= "'+campo[1].split('"')[1]+'"';
                            else  {
                                   fecha=campo[0].split('Hasta');
                                   if (fecha.length>1)
	      	                      filtro=filtro+' and '+'activosfijos.'+fecha[0]+fecha[1]+' <= "'+campo[1].split('"')[1]+'"';
	      	                   else if (campo[0]=='tiempoRestante_acf') {
                                        if (campo[1]=='"SI"')
		                                 filtro=filtro+' and '+'activosfijos.'+campo[0]+' = 0';
										else
		                                 filtro=filtro+' and '+'activosfijos.'+campo[0]+' <> 0';

							        }
									else
		                                 filtro=filtro+' and '+'activosfijos.'+campo[0]+' like "'+campo[1].split('"')[1]+'%"';

		               }
                      }
		}*/	
	//		alert(filtro);
	var sucursal = getCookie('serial_suc');
	var tipoevaluacion = query[1];	
	var periodo = query[2];
	var paradicional = query[3]; //para cojer el alumno
	//alert(tipoevaluacion + sucursal + periodo);
	//alert(sucursal + " /tipo " + query[1] + " /periodo " + query[2] + " /alumno " + query[3]);
	
	//alert(paradicional)


if (tipoevaluacion==1){

//alert("si");
/*var sqlCommand='select serial_alu, apellidopaterno_alu from alumno';
alert(sqlCommand); 
  omniObj=new omnisoftGrid('omniObj','activosfijos','serial_alu',sqlCommand,'',1020,550,'',1020,550,Array(false,false,false));

  omniObj.addColumn('Serial','serial_alu', 1,'hidden','','middle','#ffffcc');
  omniObj.addColumn('Primer Apellido','apellidopaterno_alu', 30,'string','','middle','#ffffcc');
  
  omniObj.showGrid('omniObj',20,482,1020,'menu','#FF9900');*/

/*prompt('Grid..',sqlCommand);*/

if(paradicional=='TODOS'){	
		paradicional = "";
	}
	else{
		paradicional = ' and alu.serial_alu =' + paradicional;
	}
var sqlCommand=' select ce.serial_ceva, apellidopaterno_alu, apellidomaterno_alu, nombre1_alu, nombre2_alu, mat.nombre_mat,NOMBREHORARIO_HRR, "NO EVALUADO"  AS evalua from alumno as alu, materiamatriculada as mmat, materia as mat, cabecera_evaluacion as ce RIGHT join detallemateriamatriculada as dmat on ce.serial_dmat = dmat.serial_dmat  join horario on horario.serial_hrr=dmat.serial_hrr and estado_hrr="ACTIVO" where mmat.serial_mmat = dmat.serial_mmat and serial_ceva is null and mmat.serial_alu = alu.serial_alu and fecharetiro_dmat="0000-00-00" and dmat.serial_mat = mat.serial_mat and mmat.serial_per = '+ periodo + paradicional

//+ ' order by ce.serial_ceva, apellidopaterno_alu'
//alert(sqlCommand);
//prompt("sql:",sqlCommand);

  omniObj=new omnisoftGrid('omniObj','alumno','serial_ceva',sqlCommand,'',1020,550,'',1020,550,Array(false,false,false));
  omniObj.addColumn('Serial','serial_ceva', 1,'hidden','','middle','#ffffcc'); 
  omniObj.addColumn('Primer Apellido','apellidopaterno_alu', 12,'string','','middle','#ffffcc');
  omniObj.addColumn('Segundo Apellido','apellidomaterno_alu', 12,'string','','middle','#ffffcc');
  omniObj.addColumn('Primer Nombre','nombre1_alu', 12,'string','','middle','#ffffcc');
  omniObj.addColumn('Segundo Nombre','nombre2_alu', 12,'string','','middle','#ffffcc');  
  omniObj.addColumn('Materia','nombre_mat', 30,'string','','middle','#ffffcc');
  omniObj.addColumn('Horario','NOMBREHORARIO_HRR', 30,'string','','middle','#ffffcc');
  omniObj.addColumn('Estado','evalua', 30,'string','','middle','#ffffcc');
  omniObj.showGrid('omniObj',20,482,1020,'menu','#FF9900');
 }
   
   
if(tipoevaluacion==2){

if(paradicional=='TODOS'){	
		paradicional = "";				
	}
	else{
		paradicional = ' and hrr.serial_epl ='+ paradicional;		
	}
/*var sqlCommand='SELECT ce.serial_ceva, apellido_epl, nombre_epl, nombre_mat,nombre_per, case when ce.serial_ceva is null then "NO EVALUADO" else "EVALUADO" end as evalua FROM empleado, materia, periodo, horario as hrr left join cabecera_evaluacion as ce on  ce.serial_teva = '+ tipoevaluacion +' and ce.serial_per = '+ periodo +' and ce.SERIAL_hrr=hrr.serial_hrr WHERE hrr.serial_epl = empleado.serial_epl and hrr.serial_mat = materia.serial_mat and hrr.serial_per = periodo.serial_per';*/
//var sqlCommand='select hrr.serial_hrr, apellido_epl, nombre_epl, nombre_mat,"NO EVALUADO" evalua from  empleado as epl,materia as mat, cabecera_evaluacion as ce RIGHT join horario as hrr on hrr.serial_hrr = ce.serial_hrr and ce.serial_teva = 2 join horario on horario.serial_hrr=dmat.serial_hrr and estado_hrr="ACTIVO" where epl.serial_epl = hrr.serial_epl and  ce.serial_ceva is null and mat.serial_mat = hrr.serial_mat and hrr.serial_per ='+ periodo + paradicional;


var sqlCommand='select hrr.serial_hrr, apellido_epl, nombre_epl, nombre_mat,NOMBREHORARIO_HRR,  "NO EVALUADO"  as evalua from  empleado as epl,materia as mat, cabecera_evaluacion as ce RIGHT join horario as hrr on hrr.serial_hrr = ce.serial_hrr and ce.serial_teva = 2 where epl.serial_epl = hrr.serial_epl and  estado_hrr=\'ACTIVO\' and mat.serial_mat = hrr.serial_mat and serial_ceva is null and hrr.serial_per ='+ periodo + paradicional;  

//prompt("",sqlCommand)

  omniObj=new omnisoftGrid('omniObj','empleado','serial_hrr',sqlCommand,'',1020,550,'',1020,550,Array(false,false,false));
  
  omniObj.addColumn('Serial','serial_hrr', 1,'hidden','','middle','#ffffcc');
  omniObj.addColumn('Apellido del Profesor','apellido_epl', 30,'string','','middle','#ffffcc');
  omniObj.addColumn('Nombre del Profesor','nombre_epl', 30,'string','','middle','#ffffcc');
  omniObj.addColumn('Materia','nombre_mat', 30,'string','','middle','#ffffcc');  
  omniObj.addColumn('Horario','NOMBREHORARIO_HRR', 30,'string','','middle','#ffffcc');
  omniObj.addColumn('Estado','evalua', 30,'string','','middle','#ffffcc');
  omniObj.showGrid('omniObj',20,482,1020,'menu','#FF9900');
}

if(tipoevaluacion==3){
/*var sqlCommand='SELECT serial_hrr, concat_ws(" ",apellido_epl,nombre_epl) as profesor,nombre_mat,nombre_per FROM horario, empleado, materia, periodo WHERE horario.serial_epl = empleado.serial_epl and horario.serial_mat = materia.serial_mat and horario.serial_per = periodo.serial_per and horario.serial_per = '+ periodo +' and periodo.serial_suc = '+ sucursal +' and serial_hrr not in (select serial_hrr from cabecera_evaluacion where serial_teva = 3 and serial_per = '+ periodo +')';*/
//sqlCommand='select ce.serial_ceva, epl.apellido_epl,epl.nombre_epl, mat.nombre_mat, case when ce.serial_ceva is null then "NO EVALUADO" else "Evaluado" end as evalua from materia as mat, horario as hrr, area as are,jefearea as ja, empleado as epl left join cabecera_evaluacion as ce on ce.serial_teva = '+ tipoevaluacion +' and hrr.serial_per = '+ periodo +' and ce.SERIAL_hrr=hrr.serial_hrr where hrr.serial_are = are.serial_are and are.serial_are = ja.serial_are and epl.serial_epl = ja.serial_epl and mat.serial_mat = hrr.serial_mat';

  /*omniObj=new omnisoftGrid('omniObj','activosfijos','serial_hrr',sqlCommand,'',1020,550,'',1020,550,Array(false,false,false));
  
 omniObj.addColumn('Serial','serial_hrr', 1,'hidden','','middle','#ffffcc');
  omniObj.addColumn('Apellido del Profesor','profesor', 30,'string','','middle','#ffffcc');
  omniObj.addColumn('Nombre del Profesor','nombre_mat', 30,'string','','middle','#ffffcc');
  omniObj.addColumn('Materia','nombre_mat', 30,'string','','middle','#ffffcc');  
  omniObj.addColumn('Estado','evalua', 30,'string','','middle','#ffffcc');
  omniObj.showGrid('omniObj',20,482,1020,'menu','#FF9900');*/
  
  if(paradicional=='TODOS'){	
		paradicional = "";				
	}
	else{
		paradicional = ' and hrr.serial_epl ='+ paradicional;		
	}
/*var sqlCommand='SELECT ce.serial_ceva, apellido_epl, nombre_epl, nombre_mat,nombre_per, case when ce.serial_ceva is null then "NO EVALUADO" else "EVALUADO" end as evalua FROM empleado, materia, periodo, horario as hrr left join cabecera_evaluacion as ce on  ce.serial_teva = '+ tipoevaluacion +' and ce.serial_per = '+ periodo +' and ce.SERIAL_hrr=hrr.serial_hrr WHERE hrr.serial_epl = empleado.serial_epl and hrr.serial_mat = materia.serial_mat and hrr.serial_per = periodo.serial_per';*/
var sqlCommand='select hrr.serial_hrr, apellido_epl, nombre_epl, nombre_mat,NOMBREHORARIO_HRR, "NO EVALUADO" as evalua from  empleado as epl,materia as mat, cabecera_evaluacion as ce RIGHT join horario as hrr on hrr.serial_hrr = ce.serial_hrr and ce.serial_teva = 3 and estado_hrr="ACTIVO" where ce.serial_ceva is null and epl.serial_epl = hrr.serial_epl and mat.serial_mat = hrr.serial_mat and hrr.serial_per ='+ periodo + paradicional; 
//prompt("",sqlCommand);
//alert(sqlCommand)

  
  omniObj=new omnisoftGrid('omniObj','empleado','serial_hrr',sqlCommand,'',1020,550,'',1020,550,Array(false,false,false));
  
  omniObj.addColumn('Serial','serial_hrr', 1,'hidden','','middle','#ffffcc');
  omniObj.addColumn('Apellido del Profesor','apellido_epl', 30,'string','','middle','#ffffcc');
  omniObj.addColumn('Nombre del Profesor','nombre_epl', 30,'string','','middle','#ffffcc');
  omniObj.addColumn('Materia','nombre_mat', 30,'string','','middle','#ffffcc');  
  omniObj.addColumn('Horario','NOMBREHORARIO_HRR', 30,'string','','middle','#ffffcc');
  omniObj.addColumn('Estado','evalua', 30,'string','','middle','#ffffcc');
  omniObj.showGrid('omniObj',20,482,1020,'menu','#FF9900');
  //prompt("sql:",sqlCommand);

}

if(tipoevaluacion==4){

//sqlCommand='select ce.serial_ceva, epl.apellido_epl,epl.nombre_epl, mat.nombre_mat, case when ce.serial_ceva is null then "NO EVALUADO" else "Evaluado" end as evalua from materia as mat, horario as hrr,empleado as epl left join cabecera_evaluacion as ce on ce.serial_teva = '+ tipoevaluacion +' and hrr.serial_per = '+ periodo +' and ce.SERIAL_hrr=hrr.serial_hrr where  epl.serial_epl = hrr.serial_epl and mat.serial_mat = hrr.serial_mat';

if(paradicional=='TODOS'){	
		paradicional = "";		
		//alert(paradicional);
	}
	else{
		paradicional = ' and ja.serial_jar ='+ paradicional;
		//alert(paradicional);		
	}
var sqlCommand='select hrr.serial_hrr, epl.APELLIDO_EPL, epl.NOMBRE_EPL, ar.nombre_are, hrr.NOMBREHORARIO_HRR, "NO EVALUADO" AS evalua from   empleado as epl, area as ar,cabecera_evaluacion as ce RIGHT join horario as hrr on ce.SERIAL_HRR = hrr.SERIAL_HRR and estado_hrr="ACTIVO" and ce.SERIAL_TEVA = 4   where  ce.serial_ceva is null and hrr.SERIAL_ARE = ar.serial_are and hrr.SERIAL_EPL = epl.SERIAL_EPL and hrr.serial_per ='+ periodo + paradicional ;
//prompt("",sqlCommand)
/*var sqlCommand='select hrr.serial_hrr, apellido_epl, nombre_epl, ar.nombre_are,nombre_mat,NOMBREHORARIO_HRR, "NO EVALUADO" as evalua from  empleado as epl,materia as mat, cabecera_evaluacion as ce,area as ar RIGHT join horario as hrr on hrr.serial_hrr = ce.serial_hrr and ce.serial_teva = 4 and estado_hrr="ACTIVO" where ce.serial_ceva is null and epl.serial_epl = hrr.serial_epl and mat.serial_mat = hrr.serial_mat and mat.SERIAL_ARE = ar.serial_are and hrr.serial_per ='+ periodo + paradicional;
prompt("",sqlCommand)*/
	//alert (sqlCommand)
	
	
   omniObj=new omnisoftGrid('omniObj','empleado','serial_hrr',sqlCommand,'',1020,550,'',1020,550,Array(false,false,false));
  
  omniObj.addColumn('Serial','serial_hrr', 1,'hidden','','middle','#ffffcc');
  omniObj.addColumn('Apellido del Profesor','APELLIDO_EPL', 30,'string','','middle','#ffffcc');
  omniObj.addColumn('Nombre del Profesor','NOMBRE_EPL', 30,'string','','middle','#ffffcc');
  omniObj.addColumn('Area','nombre_are', 30,'string','','middle','#ffffcc');
  omniObj.addColumn('Horario','NOMBREHORARIO_HRR', 30,'string','','middle','#ffffcc');  
  omniObj.addColumn('Estado','evalua', 30,'string','','middle','#ffffcc');  
  omniObj.showGrid('omniObj',20,482,1020,'menu','#FF9900');
  
}
</script></td>
		</tr>
		</table>
		</div>
		</td>
	</tr>
	</table>
	</div>
	</td>
</tr>
</table>
<table width="100%" height="58"  cellpadding="0" cellspacing="0" >
<tr>
<td class="menuborder"> </td>
</tr>
</table>
</body>

              
</HTML>