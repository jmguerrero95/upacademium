<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>INGENIUM::ERP::ENTERPRISE RESOURCE PLANNING</title>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<script>
var useBSNns = true;

$(document).ready(
		function()
		{
			$('#dock2').Fisheye(
				{
					maxWidth: 60,
					items: 'a',
					itemsText: 'span',
					container: '.dock-container2',
					itemWidth: 40,
					proximity: 80,
					alignment : 'left',
					valign: 'bottom',
					halign : 'center'
				}
			)
		}
	);


window.status='Diseñado y Desarrollado por Omnisoft Cia Ltda http://www.omnisoft.cc';
</script>

<link href='../lib/autosuggest2/css/autosuggest_inquisitor.css' rel="stylesheet" type="text/css">
<link href='../lib/aw/styles/xp/aw.css'rel="stylesheet" type="text/css">
<link href='../lib/grid/styles/omnisoftGrid.css'rel="stylesheet" type="text/css">

<script language="javascript" src= "../lib/tools/cookies.js" ></script>
<script language='javascript' src="../lib/tools/omnisoftTools.js"></script>
<script language="javascript" src= "../lib/aw/lib/aw.js" ></script>
<link href="../lib/styles/omnisoft.css" rel="stylesheet" type="text/css">
<link href="../lib/tools/omnisoftValidar.css" rel="stylesheet" type="text/css">
<script language='javascript' src="../lib/tools/omnisoftValidar.js"></script>
<script language="javascript" src="../lib/mask/event-listener.js"></script>
<script language="javascript" src="../lib/mask/masked-input.js"></script>
<script language="javascript" src="../lib/mask/enter-as-tab.js"></script>
<script language="javascript" src="../lib/mask/auto-tab.js"></script>
<script language='javascript' src="../lib/grid/omnisoftDB.js"></script>
<script language='javascript' src="../lib/combo/omnisoftComboBox.js"></script>

<link rel="stylesheet" type="text/css" media="all" href="../lib/jscalendar/calendar-blue2.css" title="win2k-cold-1" />
  <script type="text/javascript" src="../lib/jscalendar/calendar.js"></script>
  <script type="text/javascript" src="../lib/jscalendar/lang/calendar-en.js"></script>
  <script type="text/javascript" src="../lib/jscalendar/calendar-setup.js"></script>

<script language="javascript" src="../lib/autosuggest2/js/bsn.AutoSuggest_2.1_comp_grid.js"> </script>
<script language="javascript" src="../lib/autosuggest2/js/bsn.AutoSuggest_2.1_comp.js"> </script>

<script language="javascript" src= "../lib/grid/omnisoftGridDetail.js" ></script>
<script>
function recuperarDatos(data) {
   setCookie('serial_ieb',data);
}

function generarIngresoEgreso() {
/*
 var SQLCommand=document.PaginaDatos.fecha_odc+"|"+document.PaginaDatos.numeroDocumento_odc.value+"|"+document.PaginaDatos.fechaEntrega_odc.value+"|"+document.PaginaDatos.plazoPago_odc.value+"|"+document.PaginaDatos.proveedor_ieb.value+"|"+document.PaginaDatos.fechaInicio_odc.value+"|"+document.PaginaDatos.fechaFin_odc.value+"|"+document.PaginaDatos.diasReposicion_odc.value+"|"+document.PaginaDatos.estado_odc.value+"|"+document.PaginaDatos.observaciones_odc.value;

//   alert(SQLCommand);
   var objDBComando=new omnisoftDB(SQLCommand,"../lib/server/omnisoftGenerarOrdenCompra.php",'recuperarDatos');
      objDBComando.executeQuery();

 setTimeout('window.location.reload()',1500);
 */
 }
 function validarFacturaCaducada() {
  var fhoy=new Date();
  var fecha=document.PaginaDatos.fechaCaducidad_ieb.value.split('-');
  var ffecha=new Date(fecha[0],fecha[1]-1,fecha[2]);
  if (fhoy.getTime()>ffecha.getTime()) {
     alert('Advertencia: La factura está caducada!');
  return false;
  }

   return true;
    }


</script>

</head>
<body >

<form method="POST" enctype="multipart/form-data"  name="PaginaDatos" onClick="highlight(event)" onKeyUp="highlight(event)">
<input name="action" type="hidden" id="action">
<input name="serial_ieb" type="hidden" id="serial_ieb" class="hidden" >
<input name="proveedor_ieb" type="hidden" id="proveedor_ieb"  class="hidden">
<input name="serial_tib" type="hidden" id="serial_tib"  class="hidden">

  <table width="780" border="0" cellspacing="0" cellpadding="0" >
    <tr  >
      <td width="150" height="52"  class="ingeniumtoptitle"></td>
      <td width="487"  class="maintoptitle fonttitle"><center>
          INVENTARIOS<br>
          INVENTARIO INICIAL
        </center></td>
      <td width="129"  class="logotoptitle"></td>
    </tr>
    <tr>
      <td height="30" colspan="3"> <table width="805" height="185" border="1" cellpadding="0" cellspacing="0"  bordercolordark="#FFFFFF" bordercolorlight="#000000"class="formtable">
          <tr>
            <td height="24"  class="inputtitle">Tipo :</td>
            <td><label>
              <input type="text" name="tipoInventario" id="tipoInventario" readonly value="Inventario Inicial">
            </label></td>
            <td width="142" class="inputtitle">Numero :</td>
            <td colspan="3"><span class="style1 style4 style5">
              <input name="numeroDocumento_ieb" type="text" id="numeroDocumento_ieb" size="10" maxlength="10" class="autoincrement" style="background-color:#FFFF00" table='ingresoegresodebodega' fieldid='serial_ieb' readonly>
              </span></td>
          </tr>
          <tr>
            <td width="174" height="24"  class="inputtitle">Proveedor/Cliente
              :</td>
            <td width="187">
			  <script>
			function seleccionarProveedor() {
			  var datos=document.PaginaDatos.serial_pvdaux.value.split('¬');
                          document.PaginaDatos.proveedor_ieb.value=datos[0];
                          document.PaginaDatos.autorizacionSri_ieb.value=datos[1];
                          document.PaginaDatos.fechaAutorizacionSri_ieb.value=datos[2];
                          document.PaginaDatos.fechaCaducidad_ieb.value=datos[3];


                          document.PaginaDatos.proveedortransporte_ieb.value=document.PaginaDatos.proveedor_ieb.value;

                          cserial_odc.objDBComando.sqlCommand='select serial_odc,concat(\'Orden No\',\' \',numerodocumento_odc,\'=>\',fecha_odc) nombre from ordendecompra where serial_pvd='+document.PaginaDatos.proveedor_ieb.value +' and estado_odc=\'PENDIENTE\' order by numerodocumento_odc';

                          cserial_odc.objDBComando.executeQuery();
                          seleccionarOrdenCompra();
			}
                      var cserial_pvd=new omnisoftComboBox('cserial_pvd','serial_pvdaux','select concat(serial_pvd,\'¬\',numeroautorizacion_pvd,\'¬\',fechaautorizacion_pvd,\'¬\',fechacaducidad_pvd) as serial,razonSocial_pvd from proveedor where estado_pvd=\'ACTIVO\' order by razonsocial_pvd','250px',false,getURLParam('serial_pvdaux'));
                          cserial_pvd.show();
                          document.PaginaDatos.serial_pvdaux.onchange=seleccionarProveedor;
					   </script>			</td>
            <td width "110" class="inputtitle">Proveedor de Transporte:</td>
            <td colspan="3">
						  <script>


                     var cproveedortransporte_ieb=new omnisoftComboBox('cproveedortransporte_ieb','proveedortransporte_ieb','select serial_pvd,razonSocial_pvd from proveedor where estado_pvd=\'ACTIVO\'','250px',true,getURLParam('proveedortransporte_ieb'));
                     cproveedortransporte_ieb.show();

					   </script>
			&nbsp;</td>
          </tr>
          <tr>
            <td height="24"  class="inputtitle">Orden Compra/Factura:</td>
            <td >
			<script>

			function seleccionarOrdenCompra() {
                        omniObj.grid.masterKeyValue=document.PaginaDatos.serial_odc.value;
                        omniObj.grid.executeQuery(omniObj.grid.rows);

			}

                     var cserial_odc=new omnisoftComboBox('cserial_odc','serial_odc','select serial_odc,concat(\'Orden No\',\' \',numerodocumento_odc,\'=>\',fecha_odc) nombre from ordendecompra where estado_odc=\'PENDIENTE\' and serial_odc='+getURLParam('serial_odc') +'order by numerodocumento_odc','250px',true,getURLParam('serial_odc'),'');
                     cserial_odc.show();
					 document.PaginaDatos.serial_odc.onchange=seleccionarOrdenCompra;

					   </script>			</td>
            <td width "110" class="inputtitle">Fecha :</td>
            <td colspan="3" ><input name="fecha_ieb" type="text" id="fecha_ieb" class="date" size="10" maxlength="10"  onBlur="esconderToolTip(); formularioGrabado=0;"></td>
          </tr>
          <tr>
            <td height="24"  class="inputtitle">Bodega Origen:</td>
            <td >
						<script>
 var cbodegaorigen_ieb=new omnisoftComboBox('cbodegaorigen_ieb','bodegaorigen_ieb','select serial_bod,nombre_bod from bodega  order by nombre_bod','250px',true,getURLParam('bodegaorigen_ieb'));
                     cbodegaorigen_ieb.show();	  </script>			</td>
            <td width "110" class="inputtitle">Bodega Destino:</td>
            <td colspan="3" >
									<script>
 var cbodegadestino_ieb=new omnisoftComboBox('cbodegadestino_ieb','bodegadestino_ieb','select serial_bod,nombre_bod from bodega  order by nombre_bod','250px',true,getURLParam('bodegadestino_ieb'));
                     cbodegadestino_ieb.show();	  </script>			</td>
          </tr>
          <tr>
            <td height="24"  class="inputtitle">No Factura:</td>
            <td ><input name="numeroSerie_ieb" type="text" id="numeroSerie_ieb" class="integer" size="6" maxlength="6"  onBlur="esconderToolTip(); formularioGrabado=0;">
            -
            <input name="numeroFactura_ieb" type="text" id="numeroFactura_ieb" class="integer" size="10" maxlength="10"  onBlur="esconderToolTip(); formularioGrabado=0;"></td>
            <td "110" class="inputtitle">Fecha Autorizacion SRI:</td>
            <td width="71" ><input name="fechaAutorizacionSri_ieb" type="text" id="fechaAutorizacionSri_ieb" class="date" size="10" maxlength="10"  onBlur="esconderToolTip(); formularioGrabado=0;"></td>
            <td width="109"  class="inputtitle">Autorizacion SRI:</td>
            <td width="110" ><span class="style1 style4 style5">
              <input name="autorizacionSri_ieb" type="text" id="autorizacionSri_ieb" class="integer" size="20" maxlength="20"  onBlur="esconderToolTip(); formularioGrabado=0;">
            </span></td>
          </tr>
          <tr>
            <td height="21"  class="inputtitle">Fecha Caducidad:</td>
            <td ><input name="fechaCaducidad_ieb" type="text" id="fechaCaducidad_ieb" class="date" size="10" maxlength="10"  onBlur="validarFacturaCaducada();esconderToolTip(); formularioGrabado=0;"></td>
            <td "110" class="inputtitle">Estado:</td>
            <td ><label>
              <select name="estado_ieb" id="estado_ieb" class="combobox">
                <option value="PENDIENTE">Pendiente</option>
                <option value="PROCESADO">Procesado</option>
              </select>
            </label></td>
            <td >&nbsp;</td>
            <td ><a href="#" onClick="generarIngresoEgreso()"><img src="../images/history.png" alt="Cargar Orden de Compra/ Factura" width="32" height="32" border="0"></a></td>
          </tr>
          <tr>
            <td height="26" colspan="6"  class="inputtitle">
			<script>
			   omnisoftLoadData(document.PaginaDatos);

   if (getURLParam('action')=='insert')
      document.PaginaDatos.fecha_ieb.value=fechaSistema();

   // var serial_ieb=getURLParam('serial_ieb');
     var serial_ieb=document.PaginaDatos.serial_odc.value;


    var sql='SELECT SERIAL_DODC, nombre_prd,promedioVentas_dodc, stockActual_dodc, diasStock_dodc,costo_dodc,  CANTIDADSUGERIDA_DODC,CANTIDADSUGERIDA_DODC*UNIDADESEMBALAJE_PRD,CANTIDADREQUERIDA_DODC, CANTIDADREQUERIDA_DODC*UNIDADESEMBALAJE_PRD, CANTIDADRECIBIDAUNIDADES_DODC/UNIDADESEMBALAJE_PRD,CANTIDADRECIBIDAUNIDADES_DODC , CANTIDADREQUERIDA_DODC-CANTIDADRECIBIDAUNIDADES_DODC/UNIDADESEMBALAJE_PRD as diferencia,(CANTIDADREQUERIDA_DODC*UNIDADESEMBALAJE_PRD-CANTIDADRECIBIDAUNIDADES_DODC),SUBTOTAL_DODC, DESCUENTODOLARES_DODC, DESCUENTOPORCENTAJE_DODC,  TOTAL_DODC,OBSERVACIONES_DODC, ESTADO_DODC,OTROSPRODUCTOS_DODC,IVA_DODC, IVA0_DODC,producto.SERIAL_PRD,SERIAL_ODC FROM producto,detalleordendecompra where CANTIDADREQUERIDA_DODC>0 and producto.serial_prd=detalleordendecompra.serial_prd and serial_odc=masterkey';
//    prompt('test',sql);
    omniObj=new omnisoftGridDetail('omniObj','serial_odc',serial_ieb,'detalleordendecompra','serial_dodc',sql,document.PaginaDatos);

     omniObj.addColumn('Serial','serial_dodc', 10,'hidden','','middle','');
     omniObj.addColumn('Producto','nombre_prd', 25,'string','','middle','');
     omniObj.addColumn('Promedio Ventas','promedioVentas_dodc', 12,'double','sum','middle','');
     omniObj.addColumn('Stock Actual','stockActual_dodc', 12,'integer','sum','middle','');
     omniObj.addColumn('Dias Stock','diasStock_dodc', 12,'integer','sum','middle','');
     omniObj.addColumn('Costo','costo_dodc', 10,'double','sum','middle','');
     omniObj.addColumn('Cant. Sugerida Cajas','cantidadSugerida_dodc', 12,'integer','sum','right','');
     omniObj.addColumn('Cant. Sugerida Unidades','cantidadSugeridaUnidades_dodc', 12,'integer','sum','right','');
     omniObj.addColumn('Cant. Requerida Cajas','cantidadRequerida_dodc', 12,'integer','','middle','');
     omniObj.addColumn('Cant. Requerida Unidades','cantidadRequeridaUnidades_dodc', 12,'integer','','middle','');
     omniObj.addColumn('Cant. Recibida Cajas','cantidadRecibida_dodc', 12,'integer','','middle','');
     omniObj.addColumn('Cant. Recibida Unidades','cantidadRecibidaUnidades_dodc', 12,'integer','','middle','','0');
     omniObj.addColumn('Requerido-Recibido Cajas','cantidaddiferencia', 12,'integer','','middle','');
     omniObj.addColumn('Requerido-Recibido Unidades','cantidaddiferenciaUnidades', 12,'integer','','middle','');
     omniObj.addColumn('Subtotal','subtotal_dodc', 2,'hidden','','middle','','1');


//  omniObj.grid.fixedLeft(3);
  omniObj.showGrid('omniObj',12,308,1020,'menu','#FF9900');

</script>			</td>
          </tr>
        </table></td>
    </tr>
    <tr >      <td height="30" colspan="3" align="center" class="menuborder"> <table width="805" border="0" cellpadding="0" cellspacing="0"  >
          <tr>
            <td width="168" height="31">
<div  id="divGuardar" style="visibility:visible"><a href="#"  onClick="javascript:omnisoftGrabar()"><img src="../images/save.png" width="48" height="48" border="0" align="middle">Grabar</a></div></td>
            <td width="165"><a href="#"  onClick="javascript:omnisoftGrabar()"><img src="../images/saveas.jpg" alt="" width="48" height="48" border="0" align="middle">Grabar Como</a></td>
            <td width="158"><a href="#"  onClick="javascript:omnisoftGrabar()"><img src="../images/impresora.png" alt="" width="48" height="48" border="0" align="middle">Imprimir</a></td>
            <td width="162"><a href="#"  onClick="javascript:omnisoftGrabar()"><img src="../images/ayuda.png" alt="" width="48" height="48" border="0" align="middle">Ayuda</a></td>
            <td width="152"><div  id="divCancelar" style="visibility:visible"><a href="javascript:omnisoftCancelar()"><img src="../images/cancel.png" width="48" height="48" border="0" align="middle">Cancelar</a></div></td>
          </tr>
      </table></td>
    </tr>
  </table>
</form>
<script>
    	if (getURLParam('action')!='insert') {
           document.PaginaDatos.fechaCaducidad_ieb.value=fechaSistema();
      var serial_pvdaux=getURLParam('proveedor_ieb')+'¬'+getURLParam('autorizacionSri_ieb')+'¬'+getURLParam('fechaAutorizacionSri_ieb')+'¬'+getURLParam('fechaCaducidad_ieb');

          document.PaginaDatos.serial_pvdaux.value=serial_pvdaux;

          }
          else {
          	document.PaginaDatos.fecha_ieb.value=fechaSistema();
          	document.PaginaDatos.fechaCaducidad_ieb.value=fechaSistema();
          }

	omnisoftLoadData(document.PaginaDatos);
//	OmnisoftPerfilUsuarioFormulario();
</script>
</body>
</html>